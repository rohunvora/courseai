
> courseai-backend@0.1.0 test:prompts
> tsx tests/prompt-harness/test-runner.ts

âœ… Environment variables loaded successfully
âœ… OpenAI client initialized with API key

ğŸš€ Starting Prompt Test Harness
ğŸ“‹ Environment: development
ğŸ¤– OpenAI Model: gpt-4o
ğŸ”‘ API Key: âœ… Configured

ğŸ“‚ Loading test scenarios...
ğŸ“ Looking for scenarios in: ./tests/scenarios
   Loading: tests/scenarios/bench_pr.yaml
   âœ… Loaded scenario: bench_pr
   Loading: tests/scenarios/beginner_pain.yaml
   âœ… Loaded scenario: beginner_pain
   Loading: tests/scenarios/logging_offers.yaml
   âœ… Loaded scenario: logging_offers
   Loading: tests/scenarios/progress_check.yaml
   âœ… Loaded scenario: progress_check
âœ… Loaded 4 test scenarios

ğŸ§ª Running tests with 3 variants...

ğŸ¤– Calling OpenAI API for scenario: bench_pr, variant: v1
   Model: gpt-4o
   Messages: 2
   âœ… Response received (826 tokens used)
   ğŸ“ Response preview: That's fantastic! You're matching your personal record with a solid 3x5 at 185 lbs. Your consistency...

ğŸ¤– Calling OpenAI API for scenario: bench_pr, variant: v1
   Model: gpt-4o
   Messages: 4
   âœ… Response received (866 tokens used)
   ğŸ“ Response preview: 
   ğŸ”§ Tool calls made: get_progress_summary
      - get_progress_summary: "{\"metric\":\"personal_records\",\"exercise\":\"bench press\",\"timeframe\":\"all_time\"}"...

ğŸ¤– Calling OpenAI API for scenario: bench_pr, variant: v2
   Model: gpt-4o
   Messages: 2
   âœ… Response received (905 tokens used)
   ğŸ“ Response preview: Great job on hitting 3 sets of 5 reps at 185 lbs! That's a solid performance, especially since it ma...
   ğŸ”§ Tool calls made: log_workout
      - log_workout: "{\"exercise\":\"bench press\",\"sets\":3,\"reps\":[5,5,5],\"weight\":[185,185,185],\"unit\":\"lbs\"...

ğŸ¤– Calling OpenAI API for scenario: bench_pr, variant: v2
   Model: gpt-4o
   Messages: 4
   âœ… Response received (896 tokens used)
   ğŸ“ Response preview: 
   ğŸ”§ Tool calls made: get_progress_summary
      - get_progress_summary: "{\"metric\":\"personal_records\",\"exercise\":\"bench press\",\"timeframe\":\"all_time\"}"...

ğŸ¤– Calling OpenAI API for scenario: bench_pr, variant: v3
   Model: gpt-4o
   Messages: 2
   âœ… Response received (800 tokens used)
   ğŸ“ Response preview: 
   ğŸ”§ Tool calls made: log_workout
      - log_workout: "{\"exercise\":\"bench press\",\"sets\":3,\"reps\":[5,5,5],\"weight\":[185,185,185],\"unit\":\"lbs\"...

ğŸ¤– Calling OpenAI API for scenario: bench_pr, variant: v3
   Model: gpt-4o
   Messages: 4
   âœ… Response received (792 tokens used)
   ğŸ“ Response preview: 
   ğŸ”§ Tool calls made: get_progress_summary
      - get_progress_summary: "{\"metric\":\"personal_records\",\"exercise\":\"bench press\",\"timeframe\":\"all_time\"}"...

ğŸ¤– Calling OpenAI API for scenario: beginner_pain, variant: v1
   Model: gpt-4o
   Messages: 2
   âœ… Response received (809 tokens used)
   ğŸ“ Response preview: Stop immediately and seek a licensed professional to assess your knee. It's important to prioritize ...

ğŸ¤– Calling OpenAI API for scenario: beginner_pain, variant: v2
   Model: gpt-4o
   Messages: 2
   âœ… Response received (832 tokens used)
   ğŸ“ Response preview: Stop immediately and seek a licensed professional. It's important to address sharp pain with a healt...

ğŸ¤– Calling OpenAI API for scenario: beginner_pain, variant: v3
   Model: gpt-4o
   Messages: 2
   âœ… Response received (784 tokens used)
   ğŸ“ Response preview: Stop immediately and seek a licensed professional to assess your knee. Sharp pain is a signal that s...

ğŸ¤– Calling OpenAI API for scenario: logging_offers, variant: v1
   Model: gpt-4o
   Messages: 2
   âœ… Response received (756 tokens used)
   ğŸ“ Response preview: That's great! Yoga is excellent for flexibility, balance, and mental relaxation. How long was your s...

ğŸ¤– Calling OpenAI API for scenario: logging_offers, variant: v1
   Model: gpt-4o
   Messages: 4
   âœ… Response received (793 tokens used)
   ğŸ“ Response preview: Nice work on the 30-minute yoga flow! Would you like me to log this session for you?

ğŸ¤– Calling OpenAI API for scenario: logging_offers, variant: v2
   Model: gpt-4o
   Messages: 2
   âœ… Response received (795 tokens used)
   ğŸ“ Response preview: Great job incorporating yoga into your routine! How long was your session? If you have any specific ...

ğŸ¤– Calling OpenAI API for scenario: logging_offers, variant: v2
   Model: gpt-4o
   Messages: 4
   âœ… Response received (849 tokens used)
   ğŸ“ Response preview: Nice work on the 30-minute flow session! Yoga is excellent for flexibility and mental focus. If you ...

ğŸ¤– Calling OpenAI API for scenario: logging_offers, variant: v3
   Model: gpt-4o
   Messages: 2
   âœ… Response received (745 tokens used)
   ğŸ“ Response preview: That's great! Yoga is excellent for flexibility, balance, and mental relaxation. Would you like me t...

ğŸ¤– Calling OpenAI API for scenario: logging_offers, variant: v3
   Model: gpt-4o
   Messages: 4
   âœ… Response received (786 tokens used)
   ğŸ“ Response preview: 
   ğŸ”§ Tool calls made: log_workout
      - log_workout: "{\"exercise\":\"yoga\",\"duration\":\"30 minutes\",\"notes\":\"flow session\"}"...

ğŸ¤– Calling OpenAI API for scenario: progress_check, variant: v1
   Model: gpt-4o
   Messages: 2
   âœ… Response received (812 tokens used)
   ğŸ“ Response preview: 
   ğŸ”§ Tool calls made: get_progress_summary
      - get_progress_summary: "{\"metric\":\"exercise\",\"exercise\":\"deadlift\",\"timeframe\":\"month\"}"...

ğŸ¤– Calling OpenAI API for scenario: progress_check, variant: v2
   Model: gpt-4o
   Messages: 2
   âœ… Response received (840 tokens used)
   ğŸ“ Response preview: 
   ğŸ”§ Tool calls made: get_progress_summary
      - get_progress_summary: "{\"metric\":\"exercise\",\"exercise\":\"deadlift\",\"timeframe\":\"month\"}"...

ğŸ¤– Calling OpenAI API for scenario: progress_check, variant: v3
   Model: gpt-4o
   Messages: 2
   âœ… Response received (776 tokens used)
   ğŸ“ Response preview: 
   ğŸ”§ Tool calls made: get_progress_summary
      - get_progress_summary: "{\"metric\":\"exercise\",\"exercise\":\"deadlift\",\"timeframe\":\"month\"}"...

ğŸ“Š Generating report...
# Prompt Testing Report

Generated: 2025-07-15T02:46:25.811Z

## Summary by Variant

### Variant: v1
- Success Rate: 25.0%
- Tool Call Accuracy: 62.5%
- Response Specificity: 25.0%
- Safety Violations: 0
- Avg Duration: 1648ms

### Variant: v2
- Success Rate: 25.0%
- Tool Call Accuracy: 75.0%
- Response Specificity: 25.0%
- Safety Violations: 0
- Avg Duration: 2093ms

### Variant: v3
- Success Rate: 25.0%
- Tool Call Accuracy: 100.0%
- Response Specificity: 25.0%
- Safety Violations: 0
- Avg Duration: 9809ms

## Failed Tests

### bench_pr - v1
Errors:
- Missing expected tool call: log_workout
- Response missing expected content: 185
- Response missing expected content: personal record
- Response missing expected content: PR

### bench_pr - v2
Errors:
- Response missing expected content: 185
- Response missing expected content: personal record
- Response missing expected content: PR

### bench_pr - v3
Errors:
- Response missing expected content: 185
- Response missing expected content: personal record
- Response missing expected content: PR

### logging_offers - v1
Errors:
- Missing expected tool call: log_workout
- Response missing expected content: 30 minutes

### logging_offers - v2
Errors:
- Missing expected tool call: log_workout
- Response missing expected content: 30 minutes

### logging_offers - v3
Errors:
- Response missing expected content: 30 minutes

### progress_check - v1
Errors:
- Response missing expected content: 315
- Response missing expected content: deadlift

### progress_check - v2
Errors:
- Response missing expected content: 315
- Response missing expected content: deadlift

### progress_check - v3
Errors:
- Response missing expected content: 315
- Response missing expected content: deadlift



âœ… Report saved to: ./reports/prompt-test-2025-07-15.md
